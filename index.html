<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>The Control Room</title>
	<link rel="stylesheet" type="text/css" href="style/style.css">
	<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
</head>
<body>

<!-- The sidebar html - hidden by default -->
<aside style="display:none;">
	<div class="close"><i class="fa fa-arrow-circle-left"></i></div>
	<div class="add-repo"><i class="fa fa-plus-circle"></i></div>
	<h3>Repositories:</h3>
	<div><input type="text" id="add-repo" placeholder='Type "Username/Repo"' /></div>
</aside>

<!-- The main stage to see the commit activity -->
<div id="main-layout-wrap">
	<!-- Aside Opener -->
	<div class="aside-open"><i class="fa fa-arrow-circle-right"></i></div>
	<!-- Main Layout -->
	<h2>MakerSquare Final Projects</h2>
	<p>See the Final Projects Comming Together in Real Time <sup>*</sup></p>
	<div id="commit-messages-wrap"></div>
</div>

<!-- Riot.js Templates for use around the app with javascript -->
<div id="templates">
  <script type="text/template"  class="commit">
    <div class="commit-message { recent }" data-repo="{ id }">
        <strong><a href="{ userlink }" target="_blank">{ user }</a>:</strong> { message }<br />
        <small>{ date } | <a href="{ link }" target="_blank">Link</small>
    </div>
  </script>

  <script type="text/template" class="repo">
    <div class="repo-row">
        <i class="fa fa-github"></i> <a href="{ repolink }" target="_blank"><strong>{ user } / { repo }</strong></a>
    </div>
  </script>
</div>


<!-- The Javascripts -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<!-- Utility functions -->
<script src="js/utils.js"></script>
<!-- Riot.js -->
<script src="js/vendor/riot.js"></script>
<!-- Riot.js Models -->
<script src="js/models/repos-json.js"></script>
<script src="js/models/repo.js"></script>
<!-- Riot.js Presenters -->
<script src="js/presenters/repo-commits.js"></script>
<script src="js/presenters/sidebar.js"></script>
<!-- Main js -->
<script type="text/javascript">
	$(document).ready(function() {

		//// Loop through the repos from repos-json.js
		//// or eventually from whatever is in that same object
		//// in the sidebar at the time of the call to github firing
		//// which can run on a long poll
		for (var key in repos) {
		   var obj = repos[key];
		   var user, repo;
		   for (var prop in obj) {
		      // important check that this is objects own property
		      // not from prototype prop inherited
		      if(obj.hasOwnProperty(prop)){
		      	if (prop === "user") { user = obj[prop] }
		      	if (prop === "repo") { repo = obj[prop] }
		      }
		   }
		   var repoUrl = "https://api.github.com/repos/" + user + "/" + repo + "/commits";

		   // MAKE a new instance of a github repo
		   x = new githubRepo(repo, user, repoUrl, "#commit-messages-wrap");

		   // RENDER a box of this repos commits to the main section of the page
		   x.render();

		   // RENDER a single repo in the SIDEBAR
		   x.renderSidebarRepo();
		}
	});
</script>

</body>
</html>